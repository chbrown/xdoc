<section class="hpad">
  <h1><code>xdoc</code>: a Word-to-LaTeX converter.</h1>
  <h3>Instructions:</h3>
  <ol>
    <li>Load a Word document file using the input below. This file is only
      available to your browser; it is not uploaded to any server.</li>
    <li>Preview the automatically generated <code>xdoc</code> representation
      of your document using the "XDoc" link.</li>
    <li>Generate a LaTeX representation via the "LaTeX" link. Copy and paste the
      contents of that page into a file on your computer, and render it with
      <code>pdflatex</code>.</li>
  </ol>
  <p>Only modern Word documents (those with a <code>.docx</code> extension) are supported.</p>
</section>

<section class="hpad">
  <h2>Stored documents</h2>
  <p ng-show="storedFiles.length == 0">
    You have not loaded any files. A list of loaded files will appear here after you have uploaded one.
  </p>
</section>
<table ng-show="storedFiles.length > 0" class="fill padded lined striped">
  <thead>
    <tr>
      <th title="File name">Name</th>
      <th></th>
      <th></th>
      <th title="Original file contents size">Size</th>
      <!-- <th title="MIME Type">Type</th> -->
      <th title="Last modified date">Modified</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr ng-repeat="storedFile in storedFiles">
      <td><a ui-sref="document.files({name: storedFile.name})">{{storedFile.name}}</a></td>
      <td><a ui-sref="document.xdoc({name: storedFile.name})">XDoc</a></td>
      <td><a ui-sref="document.latex({name: storedFile.name})">LaTeX</a></td>
      <!-- the storedFile.base64 getter should not trigger a base64 conversion -->
      <td class="number" title="Base64 string length: {{storedFile.base64.length}}">{{storedFile.size}}</td>
      <!-- <td>{{storedFile.type}}</td> -->
      <td>{{storedFile.lastModifiedDate | date:'MMMM d, y h:mm a'}}</td>
      <td><button ng-click="removeStoredFile(storedFile)">Remove</button>
    </tr>
  </tbody>
</table>

<section class="hpad">
  <form>
    <label>
      <div><b>Load a new Word Document</b></div>
      <input type="file" on-upload="readFile($file)">
    </label>
  </form>
</section>
